class DatingApp{constructor(){this.modal=null,this.form=null,this.isAuthenticated=!1,this.authToken=localStorage.getItem("dating_auth_token"),this.init()}init(){this.authToken&&this.checkAuthStatus(),this.bindEvents(),this.setupModal()}bindEvents(){document.getElementById("signupBtn")?.addEventListener("click",()=>this.openModal()),document.getElementById("signupForm")?.addEventListener("submit",e=>this.handleFormSubmit(e)),document.getElementById("modalClose")?.addEventListener("click",()=>this.closeModal()),document.addEventListener("keydown",e=>{"Escape"===e.key&&this.modal?.classList.contains("active")&&this.closeModal()}),document.getElementById("email")?.addEventListener("blur",e=>this.validateEmail(e.target.value)),document.getElementById("password")?.addEventListener("blur",e=>this.validatePassword(e.target.value)),document.getElementById("email")?.addEventListener("input",e=>this.clearError("emailError")),document.getElementById("password")?.addEventListener("input",e=>this.clearError("passwordError"))}setupModal(){this.modal=document.getElementById("signupModal"),this.form=document.getElementById("signupForm")}openModal(){this.modal&&(this.modal.classList.add("active"),document.body.style.overflow="hidden",document.getElementById("email")?.focus())}closeModal(){this.modal&&(this.modal.classList.remove("active"),document.body.style.overflow="",this.resetForm())}resetForm(){this.form&&(this.form.reset(),this.clearAllErrors(),this.hideSuccessMessage())}validateEmail(e){var t=document.getElementById("email");return e?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e)?(this.clearError("emailError"),t.classList.remove("error"),!0):(this.showError("emailError","Please enter a valid email address"),t.classList.add("error"),!1):(this.showError("emailError","Email is required"),t.classList.add("error"),!1)}validatePassword(e){var t=document.getElementById("password");return e?e.length<8?(this.showError("passwordError","Password must be at least 8 characters long"),t.classList.add("error"),!1):(this.clearError("passwordError"),t.classList.remove("error"),!0):(this.showError("passwordError","Password is required"),t.classList.add("error"),!1)}showError(e,t){e=document.getElementById(e);e&&(e.textContent=t)}clearError(e){e=document.getElementById(e);e&&(e.textContent="")}clearAllErrors(){this.clearError("emailError"),this.clearError("passwordError"),document.getElementById("email")?.classList.remove("error"),document.getElementById("password")?.classList.remove("error")}showSuccessMessage(){var e=document.getElementById("successMessage"),t=document.getElementById("signupForm");e&&t&&(t.style.display="none",e.style.display="flex")}hideSuccessMessage(){var e=document.getElementById("successMessage"),t=document.getElementById("signupForm");e&&t&&(e.style.display="none",t.style.display="flex")}async handleFormSubmit(t){t.preventDefault();var t=document.getElementById("email").value,s=document.getElementById("password").value,e=this.validateEmail(t),r=this.validatePassword(s);if(e&&r)try{await this.authenticateUser(t,s)}catch(e){try{await this.registerUser(t,s)}catch(e){console.error("Registration failed:",e),this.showError("emailError","Registration failed. Please try again.")}}}async authenticateUser(e,t){e=btoa(e+":"+t),t=await fetch("https://api.dating.com/identity",{method:"GET",headers:{Authorization:"Basic "+e,"Content-Type":"application/json"}});if(!t.ok)throw new Error("Authentication failed");e=t.headers.get("X-Token");e&&(this.authToken=e,localStorage.setItem("dating_auth_token",e),this.isAuthenticated=!0,this.redirectToAuthZone(e))}async registerUser(t,e){t=await fetch("https://api.dating.com/identity",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:e})});if(!t.ok)throw e=await t.json().catch(()=>({})),new Error(e.message||"Registration failed");{let e=t.headers.get("X-Token");e&&(this.authToken=e,localStorage.setItem("dating_auth_token",e),this.isAuthenticated=!0,this.showSuccessMessage(),setTimeout(()=>{this.redirectToAuthZone(e)},2e3))}}async checkAuthStatus(){if(this.authToken)try{(await fetch("https://api.dating.com/identity",{method:"GET",headers:{Authorization:"Bearer "+this.authToken,"Content-Type":"application/json"}})).ok?(this.isAuthenticated=!0,this.redirectToAuthZone(this.authToken)):(localStorage.removeItem("dating_auth_token"),this.authToken=null,this.isAuthenticated=!1)}catch(e){console.error("Auth check failed:",e),localStorage.removeItem("dating_auth_token"),this.authToken=null,this.isAuthenticated=!1}}redirectToAuthZone(e){window.location.href="https://www.dating.com/people/#token="+e}}document.addEventListener("DOMContentLoaded",()=>{new DatingApp});
//# sourceMappingURL=main.min.85c2326e.js.map
